---
title: "EinfÃ¼hrung in R und RStudio"
author: "Katharina Maubach & Patrick Zerrer"
toc: true
number-sections: true
highlight-style: pygments
format:
  html:
    code-fold: false
    code-line-numbers: true
---

![Artwork by @allison_horst](Bilder/Grafik%20R%20Lernen.png)

## Was ist R?

R ist eine freie Programmiersprache die auf allen gÃ¤ngigen Betriebssystemen lÃ¤uft. In seiner Grundfunktion ist R zunÃ¤chst eine Konsole, in welcher wir zeilenweise Code eingeben und ausfÃ¼hren kÃ¶nnen. Dabei kann es sich um einfache Rechnungen oder auch komplexe Modelle handeln. Die meisten arbeiten dabei nicht mit R als solches sondern nutzen verschiedene Umgebungen, etwa RStudio oder Jupyter Hub um mit R zu arbeiten.

## Was ist RStudio?

RStudio ist eine Erweiterung von R und bietete den Nutzer\*innen eine benutzerfreundlichere ProgrammoberflÃ¤che. So ermÃ¶glicht RStudio einen direkten Ãœberblick Ã¼ber die geladenen Pakete, DatensÃ¤tze und im Arbeitsverzeichnis gespeicherten Dateien. Zudem ermÃ¶glicht RStudio die Arbeit mit Skripten, Markdown und Quarto Dokumenten.

## Installation von R und RStudio

MÃ¶chtet ihr das Programm lokal auf eurem Rechner nutzen, mÃ¼sst ihr zunÃ¤chst die Programme R, RStudio und gegebenfalls RTools installieren. Alle Programme sind kostenlos online verfÃ¼gbar und lassen sich auf allen gÃ¤ngigen Betriebssystemen installieren. Installiert zunÃ¤chst [R](https://cran.uni-muenster.de/) und anschlieÃŸend [RStudio](https://posit.co/download/rstudio-desktop/) und achtet darauf regelmÃ¤ÃŸig auf die aktuelle Version zu aktualisieren.

Innerhalb unseres Kurse arbeiten wir mit R und RStudio, nutzen die Programme allerdings in der Umgebung von Jupyter.

## Die ProgrammoberflÃ¤che von RStudio

### SchaltflÃ¤chen

Innerhalb von RStudio unterscheiden wir 4 SchaltflÃ¤chen welche sich beliebig via Drag and Drop verschieben oder auch minimieren lassen.

![ ](Bilder/RStudio_ProgrammoberflÃ¤che.jpg)

**1**  Ist der Bereich in welchen wir Skripte, Markdown und Quarto-Dokumente bearbeiten und ausfÃ¼hren kÃ¶nnen (siehe auch Markdown und Quarto)

**2** Ist die Konsole. Dies ist der Bereich in welchem wir weiterhin oldschool R angezeigt bekommen. Dieser Bereich kann sehr hilfreich sein, wenn man kurz Befehle benÃ¶tigt, welche nicht im Skript auftauchen sollen (beispielsweise eine kurze Hilfe zu Funktionen mittels `?`)

**3**  In diesem Bereich findet sich alles zu den innerhalb von R geladenen DatensÃ¤tzen. Unter Environment finden sich die DatensÃ¤tze (*Data*), die Historie der genutzten Befehle (*History*), eine Schnittstelle zu Datenbanken (*Connection*) sowie R-interne Tutorials (*Tutorial*).

**4**  In diesem Bereich finden sich verschiedene Reiter, welche die Organisation der Arbeit mit R erleichtern. Unter *File* befinden sich alle innerhalb des Ordners oder Projektes befindlichen Dateien. Unter *Plots* kann man sich die in R erstellten Grafiken anzeigen lassen. *Packages* zeigt alle in R installierten Pakete an. Hier lassen sich mittels *install* auch neue Pakete installieren oder Ã¼ber *update* die aktuellen Pakete updaten. Bei *Help* kÃ¶nnen wir eine Hilfeseite aufrufen. Es kann wahlweise direkt innerhalb der Seite nach Hilfen gesucht werden oder mit dem Befehl `?Name der Funktion` bzw. `??Name des Packages` innerhalb der Konsole. MÃ¶chte man nach einem Befehl aus einem Paket suchen nutzt man den Suchbefehle`?Name des Packages::Name der Funktion`. Unter *Viewer* finden sich gerenderte Dokumente (beispielsweise ein gerendertes Markdown oder Quarto Dokument) und unter *Presentation* gerenderte Shiny-Dokumente.

### MenÃ¼leiste

ZusÃ¤tzlich zu den SchaltflÃ¤chen findet sich oben links eine MenÃ¼leiste:

![ ](Bilder/MenÃ¼leiste.jpg)

- Unter *File* kÃ¶nnen neue Dateien erstellt, geÃ¶ffnet und gespeichert werden. 
- *Edit* bietet MÃ¶glichkeiten der Dateibearbeitung (bspw. Kopieren, Ausschneiden, RÃ¼ckgÃ¤ngig etc.) falls ihr keine Short-Cuts nutzen wollt. 
- *Code* gibt eine Ãœbersicht Ã¼ber Funktionen innerhalb des Markdown-Dokumentes (bspw. Codechunks einfÃ¼gen). 
- Unter *View* kÃ¶nnen die einzelnen SchaltflÃ¤chen und deren Aufteilung geÃ¤ndert werden. Wahlweise geht dies auch via Drag & Drop. 
- *Plots* vereinfacht den Umgang mit in r erstellten Grafiken. Wahlweise kÃ¶nnt ihr hier auch den Reiter Plots in SchaltflÃ¤che 4 nutzen. 
- *Session* hier kann eine R-Session neu gestartet oder beendet werden (siehe auch [1.6 Die Session](https://patrickzerrer.github.io/R_Hands_on_Book/Skript_1.4.html#die-session)). 
- *Build*, *Debug* und *Profile* beinhaltet Sonderanwendungen, wie beispielsweise das [Debugging von Funktionen](https://support.posit.co/hc/en-us/articles/200713843) oder Fragen nach der [Speed-Optimierung von R-Code](https://rstudio.github.io/profvis/). 
- *Tools* hat viele hilfreiche Funktionen. Hier kÃ¶nnen unter anderem Pakete installiert und hilfreiche Keyboard Shortcuts ausgegeben werden. Am bedeutsamsten ist hier jedoch der Bereich Global Options, in welchem unter anderem grundlegende Einstellungen zum Speicherort von R und den Paketen, zur Aufteilung und Aussehen von RStudio und zur FunktionalitÃ¤t von R Markdown getroffen werden kÃ¶nnen.  
- Auch der Reiter *Help* kann sehr hilfreich sein. Hier finden sich eine Hilfeseite (siehe auch Reiter Help in SchaltflÃ¤che 4), MÃ¶glichkeiten der besseren ZugÃ¤nglichkeit (*Accessibility*), *Cheat Sheets* fÃ¼r die Arbeit mit R und erneut eine Ãœbersicht Ã¼ber Shortcuts fÃ¼r die Arbeit mit R.   

## Die Grundlogik von R

Wie bereits zuvor erwÃ¤hnt ist R eine Programmiersprache. Das bedeutet, dass alle Schritte in R, vom Datenmanagement bis zu komplizierteren statistischen Analysen, mit Befehlen bzw. Funktionen erfolgen. GrundsÃ¤tzlich funktionieren Befehle so, dass zunÃ¤chst der Befehl erfolgt und in Klammern anschlieÃŸend worauf sich dieser Befehl bezieht.

Dabei kÃ¶nnen sich manche Befehle auf den gesamten Datensatz beziehen (etwa der Befehl `str` der die Struktur des Datensatzes anzeigt) oder auch jeweils nur auf einzelne Variablen (beispielsweise wenn wir den Mittelwert einer einzelnen Variablen des Datensatzes ermitteln wollen). 

FÃ¼r den Befehl `str()` sieht die Code-Zeile bei einem Datensatz names `data` wie folgt aus:

```{r, eval=F, message=F, warning=F}
str(data)
```

FÃ¼r die Berechnung des Mittelwertes mit der Funktion `mean()` mÃ¼ssen wir R ebenfalls den Datensatz nennen, auf welchen wir uns beziehen wollen (ğŸ’¡ Fun-Fact, R "denkt nicht mit", also auch wenn fÃ¼r euch klar ist, dass ihr doch die gesamte Zeit mit dem selben Datensatz arbeitet, muss R das immer wieder gesagt bekommen). ZusÃ¤tzlich mÃ¼ssen wir die Variable angeben, von welcher der Mittelwert berechnet werden soll. Datensatz und Variable kÃ¶nnen wir dabei mit einem Dollarzeichen `$` verbinden, dass sagt R, dass es sich um die Variable aus dem jeweiligen Datensatz handelt. MÃ¶chten wir nun den Mittelwert der Variablen `Alter` aus dem Datensatz `data` berechnen, sieht der Code wie folgt aus:

```{r, eval=F, message=F, warning=F}
mean(data$Alter)
```

Dabei haben die meisten Funktionen noch weitere Zusatzoptionen, welche wir nutzen kÃ¶nnen. Bei dem Befehl `mean` kÃ¶nnen wir beispielsweise angeben, ob fehlende Werte in die Berechnung mit einflieÃŸen sollen oder nicht. Dies geschieht mit den Zusatz `na.rm = TRUE` bzw. `na.rm = FALSE`. `Na.rm` steht in diesem Fall fÃ¼r NA (=not available, fehlende FÃ¤lle) und remove (also entfernen), fragt demnach ob fehlende FÃ¤lle aus der Berechnung ausgeschlossen werden sollen. Dabei ist die *default-Option*, also die Option die in dem Befehl voreingestellt ist, dass fehlende Werte nicht aus der Berechnung ausgeschlossen werden (`na.rm=F`). Die meisten Befehle haben bestimmte defaults, da dies diese den Normalfall der Nutzung beschreiben und uns beim Programmieren Schreibaufwand ersparen (mÃ¶chten wir die defaults nutzen, mÃ¼ssen wir immerhin nichts zusÃ¤tzliches in der Funktion angeben). Allerdings kÃ¶nnen wir hier auch immer die anderen Optionen nutzen, wir mÃ¼ssen dies nur in unserem Befehl angeben:


```{r, eval=F, message=F, warning=F}
mean(data$Alter, na.rm=T)
```

Hier haben wir auch bereits eine weitere FunktionalitÃ¤t von R kennengelernt, nÃ¤mlich die Operationalisierung einzelner Parameter Ã¼ber `T` (`TRUE`) und `F` (`FALSE`). Doch woher weiÃŸ ich nun als neuer Nutzer, welche Optionen mit bei einzelnen Befehlen zur VerfÃ¼gung stehen?

Hier hilf ein Blick in die Hilfeseite, welche wir beispielsweise fÃ¼r den Mittelwert mit dem Befehl `?mean()` aufrufen kÃ¶nnen. FÃ¼r jede Funktion stehen - wie oben bereits erwÃ¤hnt - *Hilfeseiten* zur VerfÃ¼gung. Diese beinhalten zunÃ¤chst eine kurze Beschreibung *Description*, anschlieÃŸend einen Ãœberblick zur Nutzung *Usage* sowie dem *Default* des Befehles. AnschlieÃŸend finden sich die *Arguments*, dies sind die MÃ¶glichkeiten, wie wir die Funktion nutzen kÃ¶nnen und welche zusÃ¤tzlichen Optionen zur VerfÃ¼gung stehen. Oftmals finden sich zudem weitere ErklÃ¤rungen und Beispiele der Nutzung.  

### Kurz-Exkurs: das tidyverse

In R selbst findet sich eine Vielzahl von Befehlen. ZusÃ¤tzlich wird R von den Nutzern immer weiter entwickelt und es kommen neue Funktionen in Form von Paketen hinzu. Eines der meist genutzten Pakete(-universen) stellt dabei das [tidyverse](https://www.tidyverse.org/) dar. Mit den Befehlen und Funktionen dieses Paketes kommt eine etwas andere Programmiersprache, welche uns jedoch die Arbeit mit R erleichtert. Gerade auch bei Fragen des Datenmanagementes ist das tidyverse hilfreich, denn hier kommt ein zweiter Fun-Fact Ã¼ber R:ğŸ’¡ R kann nicht nur manchmal etwas dumm sein (wir erinnern uns, es denkt nicht mit), es ist auch recht vergesslich. Wir haben oben bereits gelernt, dass wir in Befehlen immer den Datensatz und die Variable spezifizieren mÃ¼ssen. Dies stellt kein Problem bei einzelnen Befehlen dar, ist jedoch bei einer Vielzahl von Befehlen etwas nervig. Hier kommt uns die tidyverse Logik zu Nutze, in welcher einmal zu Beginn des Dokumentes der Datensatz spezifziert wird und anschlieÃŸend alle weiteren Schritte durch eine Pipe `%>%` verbunden werden. Die Pipe (Shortcut Windows: Ctrl + Shift + M; MAC: Cmd + Shift + M) bedeutet so viel wie "und dann". Also im Prinzip sagen wir R, nehme diesen Datensatz und dann mache die folgenden Dinge, wobei wir so viele Schritte wie wir mÃ¶chten jeweils mit Pipes verbinden kÃ¶nnen. Wir nutzen in unseren Skripten hauptsÃ¤chlich die tidyverse-Logik, erklÃ¤ren diese daher grundlegender in Kapitel [3.1](https://patrickzerrer.github.io/R_Hands_on_Book/Skript_3.1.html), wenn wir uns mit den ersten Schritten des Datenmanagements beschÃ¤ftigen.       

## Pakete

R-Pakete sind Erweiterungen, die Funktionen, Daten, Code und dessen Dokumentation enthalten und uns damit unsere Arbeit deutlich erleichtern. Diese erweiteren die Funktionen, die bereits in der StandardausfÃ¼hrung von R (bekannt als base R) gegeben sind. 

### Die Installation von Paketen

Pakete kÃ¶nnen wahlweise R-intern Ã¼ber *CRAN* (das steht fÃ¼r *Comprehensive R Archive Network* und ist das zentrale Software-Repository) oder direkt von GitHub (fÃ¼r sehr neue Pakete, welche noch nicht auf CRAN sind) installiert werden. Im Normalfall installieren wir jedoch direkt von CRAN, da hier eine Vielzahl von Paketen und Funktionen vorhanden sind und die Installation sehr simpel ist. 

Wenn wir ein R-Paket von CRAN installieren mÃ¶chten nutzen wir die Funktion `install.packages()`, in deren Klammer wir in AnfÃ¼hrungszeichen den Namen des zu installierenden Pakets setzen. FÃ¼r das Paket `tidyverse` wÃ¤re der Befehl wie folgt:

```{r ,eval=F, message=F, warning=F}
install.packages("tidyverse")
```

Beim AusfÃ¼hren des Codes gibt R in der Konsole Auskunft Ã¼ber die verschiedenen Installationsschritte sowie Ã¼ber den (Mis-)Erfolg der Installation. Alternativ kÃ¶nnt ihr auch Ã¼ber das RStudio Interface Pakete installieren. HierfÃ¼r geht ihr in der rechten unteren Ecke auf den Reiter `Packages` und wÃ¤hlt den Buttion `Install` aus. In dem sich Ã¶ffnenen Fenster gebt ihr den Namen des von euch gewÃ¼nschten Pakets ein und bestÃ¤tigt die Anwendung wiederum mit `Install`.

![Screenshot RStudio](Bilder/Skript_1_4_Screenshot4.png) 

Einige der Pakete, die wir im Rahmen des Kurses verwenden sind bereits in der R Cloud vorinstalliert und mÃ¼ssen nicht mehr von euch eigenhÃ¤ndig installiert werden. GrundsÃ¤tzlich ist es jedoch immer ratsam, einmal zu checken, ob die Pakete in der aktuellen Version installiert sind, da ansonsten die Funktionen der Pakete nicht funktionieren kÃ¶nnen.

### Das Laden von Paketen

Im vorherigen Schritt haben wir bereits die von uns benÃ¶tigten Pakete installiert, jetzt mÃ¼ssen wir R nur noch sagen, dass wir diese Pakete fÃ¼r die aktuelle Session nutzen mÃ¶chten. Ihr kÃ¶nnt euch das so vorstellen, dass ihr die benÃ¶tigten Pakete *aktiv* schaltet. Dies geschieht mit dem `library` Befehl (Achtung, hier benÃ¶tigen wir im Gegensatz zum `install.packages` Befehl keine AnfÃ¼hrungszeichen):

```{r ,eval=F, message=F, warning=F}
library(tidyverse)
```

Wir nutzen in diesem Kurs wiederum `pacman`, um automatisch mehrere Pakete installieren und laden zu kÃ¶nnen. DafÃ¼r installieren und laden wir einmalig das Paket `pacman` und kÃ¶nnen anschlieÃŸend mit der Funktion `p_load` die von euch in der Klammer angegebenen Pakete installieren und laden:  

```{r , eval=F, message=F, warning=F}
if(!require("pacman")) {install.packages("pacman");library(pacman)}
p_load(tidyverse, ggplot2, haven, psych, psy, nFactors, htmlTable) 
```

Ansonsten habt ihr noch die MÃ¶glichkeit die Pakete hÃ¤ndisch Ã¼ber das R Studio Interface zu aktiveren, was ich persÃ¶nlich ab einer gewissen Anzahl von benÃ¶tigten Paketen eher nervig finde. Nichtsdestotrotz kÃ¶nnt ihr hierfÃ¼r in der rechten unteren Ecke des Interfaces auf den Reiter `Packages` gehen und in der unteren Liste das gewÃ¼nschte Paket durch das Setzen eines Hakens auswÃ¤hlen.

![Screenshot RStudio](Bilder/Skript_1_4_Screenshot5.png)



::: callout-note
## WeiterfÃ¼hrende Literatur

> ğŸ“– Gehrau, V., Maubach, K., & Fujarski, S. (2022). Einfache Datenauswertung mit R. [Link](https://link.springer.com/book/10.1007/978-3-658-34285-2)
:::
